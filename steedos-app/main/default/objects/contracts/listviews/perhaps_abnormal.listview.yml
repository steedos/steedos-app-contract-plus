name: perhaps_abnormal
label: 可能异常
filter_scope: space
show_count: true
filters: !<tag:yaml.org,2002:js/function> |-
  function anonymous(
  ) {

      var dayTime = 24 * 60 * 60 * 1000;
      var time =  new Date().getTime() + dayTime;
      time = new Date(moment(time).format('YYYY-MM-DD'));
      return [
        [["contract_state","=","异常"]],
        'or',
        [["last_date_delivery", "<", time],["delivery_date","=", null]],
        "or",
        [["last_date_acceptance", "<", time],["acceptance_date","=", null]],
        "or",
        [["last_date_payment", "<", time],["payment_date","=", null]]
      ];

  }
columns:
  - field: 'no'
    width: 100
    wrap: true
  - field: name
    width: 200
    wrap: true
  - field: project
    width: 100
    wrap: true
  - field: othercompany
    width: 260
    wrap: true
  - field: company_id
    width: 140
    wrap: true
  - field: contract_type
    width: 100
    wrap: true
  - field: is_bidding
    width: 100
    wrap: true
  - field: signed_date
    width: 100
    wrap: true
  - field: start_date
    width: 100
    wrap: true
  - field: end_date
    width: 100
    wrap: true
  - field: amount
    width: 100
    wrap: true
  - field: advance_amount
    width: 100
    wrap: true
  - field: outstanding_amount
    width: 100
    wrap: true
  - field: contract_state
    width: 100
    wrap: true
  - field: subject
    width: 100
    wrap: true
  - field: a_signed
    width: 100
    wrap: true
  - field: b_signed
    width: 100
    wrap: true
  - field: description
    width: 100
    wrap: true
  - field: last_date_delivery
    width: 100
    wrap: true
  - field: delivery_date
    width: 100
    wrap: true
  - field: last_date_acceptance
    width: 100
    wrap: true
  - field: acceptance_date
    width: 100
    wrap: true
  - field: last_date_payment
    width: 100
    wrap: true
  - field: payment_date
    width: 100
    wrap: true
filter_fields:
  - company_id
  - contract_type
  - signed_date
  - othercompany
  - contract_state
sort:
  - - signed_date
    - desc
  - - company_id
    - desc
