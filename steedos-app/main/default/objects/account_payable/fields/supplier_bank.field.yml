name: supplier_bank
label: 收款方银行账号
optionsFunction: !<tag:yaml.org,2002:js/function> |-
  function anonymous(values
  ) {

    if (!values || !values.supplier) {
      return [];
    }
    var accountId = _.isObject(values.supplier) ? values.supplier._id : values.supplier;;
    var options, result, supplier_banks;
    result = [];
    options = {
      $filter: `(account eq '${accountId}') and (enablestate eq '2')`,
      $select: 'accnum'
    };
    supplier_banks = Creator.odata.query('account_banks', options, true);
    supplier_banks.forEach(function (sb) {
      return result.push({
        label: sb.accnum,
        value: sb._id
      });
    })
    return result;

  }
reference_to: account_banks
required: true
sort_no: 160
type: lookup
